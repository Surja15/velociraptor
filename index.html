<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Speed Reader by Surja</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
    margin: 0;
    padding: 20px 20px 120px 20px; /* extra bottom padding for scrollable area */
    background: #111;
    color: #eee;
    font-family: system-ui, sans-serif;
}


        .text-container {
            width: 100%;
            height: 30vh;
            font-size: 16px;
            padding: 10px;
            background: #1c1c1c;
            color: #eee;
            border: 1px solid #444;
            box-sizing: border-box;
            overflow-y: auto;
            line-height: 1.5em;
        }

        .text-container span {
    cursor: pointer;
    display: inline;
}

        .highlight {
    background: rgba(42, 92, 255, 0.3);   /* soft translucent blue */
    border-radius: 3px;
    box-shadow: 0 0 8px rgba(42, 92, 255, 0.4); /* subtle blue glow */
    transition: background 0.2s, box-shadow 0.2s;
}


        .controls {
            margin: 10px 0;
        }

        .controls button {
            margin-left: 5px;
            font-size: 16px;
            padding: 5px 10px;
            cursor: pointer;
        }

        .reader {
            height: 40vh;
            position: relative;
            overflow: hidden;
            border-top: none;
        }

        .word {
            position: absolute;
            top: 50%;
            left: 0;
            white-space: nowrap;
            font-size: 40px;
            transform: translateY(-50%);
        }

        .pivot {
            color: red;
        }
        .text-container span:hover {
    background: rgba(0, 200, 100, 0.28);
    border-radius: 3px;
}


        h1 {
            margin: 0 0 20px 0;
        }
        #bottomPanel {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    background: rgba(28, 28, 28, 0.2); /* very transparent */
    color: #eee;
    text-align: center;
    padding: 8px 0;
    font-size: 14px;
    border-top: 1px solid rgba(255,255,255,0.1);
    backdrop-filter: blur(.75px); /* stronger blur makes text behind diffused */
    -webkit-backdrop-filter: blur(6px); /* Safari support */
    z-index: 900;
}

.controls {
    display: flex;
    justify-content: space-between;
    align-items: center;
}
#progressBar {
    width: 100%;
    height: 6px;
    background: #222;
    border-radius: 4px;
    overflow: hidden;
    margin: 10px 0;
}

#progressFill {
    height: 100%;
    width: 0%;
    background: linear-gradient(
        90deg,
        #555,
        #888,
        #aaa
    );
    transition: width 0.15s linear;
}

        #funFacts {
    position: fixed;
    bottom: 36px;            /* space above bottom panel */
    left: 12px;
    right: 12px;
    max-height: 40vh;        /* so it won‚Äôt exceed screen */
    overflow-y: auto;        /* scrollable if too long */
    background: #1c1c1c;
    color: #ccc;
    padding: 8px 12px;
    font-size: 12px;
    border: 1px solid #444;
    border-radius: 4px;
    z-index: 1000;           /* above bottom panel */
}


        #funFacts ul {
    margin: 0;
    padding-left: 18px;
    padding-bottom: 12px;  /* prevent last item from touching edge */
}






    </style>
</head>
<body>
    <h1>
        ùöüùöéùöïùöòùöåùöí<span style="color:red;">ùöõ</span>ùöäùöôùöùùöòùöõ
    </h1>
    <div style="color:#777; font-size:14px; margin-top:4px;">
    Paste text below and press ‚ñ∂...
    </div>

    <div id="text" class="text-container" contenteditable="true" placeholder="Paste your text here..."></div>

    <div class="controls">
    <div>
        WPM: <input type="number" id="wpm" value="200">
        <button id="playPauseBtn" onclick="togglePlayPause()">‚ñ∂</button>
        <button onclick="stop()">Reset</button>
    </div>

    <div style="color:#777; font-size:14px;">
        click on word to seek / skip to‚Ä¶
    </div>
</div>
<div id="progressBar">
    <div id="progressFill"></div>
</div>


    <div class="reader">
        <div id="display" class="word"></div>
    </div>
    <div style="margin-top:12px; color:#aaa; font-size:13px; line-height:1.4em;">
    <details>
        <summary>‚úß Click for fun facts about reading speeds ‚úß</summary>
        <ul>
            <li>Average adult reading speed: 200‚Äì300 WPM.</li>
            <li>RSVP can temporarily push 400‚Äì700 WPM for short bursts.</li>
            <li>Spritz-style (used here) reduces eye movement using a highlighted pivot letter.</li>
            <li>Skimming can exceed 1000 WPM, but recall drops.</li>
            <li>Reading too fast reduces comprehension above ~500 WPM.</li>
            <li>RSVP minimizes eye saccades by showing one word at a time.</li>
            <li>Chunking 2‚Äì3 words improves speed and comprehension.</li>
            <li>Practice can increase speed 20‚Äì50% over weeks.</li>
            <li>Comprehension is more important than raw speed.</li>
            <li>Reading endurance matters ‚Äî speed alone isn‚Äôt enough.</li>
            <li>Reading speed varies by language and script.</li>
        </ul>
    </details>
</div>

    <script>
        let words = [];
        let i = 0;
        let timer = null;
        let isPlaying = false;

        function pivotIndex(word) {
            if (word.length <= 3) return 0;
            if (word.length <= 6) return 1;
            if (word.length <= 9) return 2;
            return Math.floor(word.length / 3);
        }

        function render(word) {
    if (!word) return "";

    // Determine pivot index based on letters/digits only
    const clean = word.replace(/[^a-zA-Z0-9]/g, "");
    if (!clean) return word; // for punctuation-only "words"

    const p = pivotIndex(clean);

    // Find the real index of the pivot in the original word
    let letterCount = 0;
    let pivotIndexInOriginal = 0;
    for (let i = 0; i < word.length; i++) {
        if (/[a-zA-Z0-9]/.test(word[i])) letterCount++;
        if (letterCount - 1 === p) {
            pivotIndexInOriginal = i;
            break;
        }
    }

    return word.slice(0, pivotIndexInOriginal) +
           `<span class="pivot">${word[pivotIndexInOriginal]}</span>` +
           word.slice(pivotIndexInOriginal + 1);
}


        function lockPivot() {
            const display = document.getElementById("display");
            const pivot = display.querySelector(".pivot");
            if (!pivot) return;

            display.style.transform = "translateY(-50%)";

            const pivotRect = pivot.getBoundingClientRect();
            const pivotCenter = pivotRect.left + pivotRect.width / 2;
            const targetX = window.innerWidth / 2;
            const shiftX = targetX - pivotCenter;

            display.style.transform = `translate(${shiftX}px, -50%)`;
        }

        function delayFor(word, base) {
            let d = base;
            const len = word.replace(/[^a-zA-Z0-9]/g, "").length;

            if (len <= 3) d *= 0.75;
            else if (len >= 8 && len <= 11) d *= 1.25;
            else if (len >= 12) d *= 1.5;

            if (/[.!?]$/.test(word)) d *= 2;
            else if (/[,:]$/.test(word)) d *= 1.3;

            return d;
        }

        function highlightCurrentWord(index) {
            const textEl = document.getElementById("text");
            textEl.querySelectorAll("span").forEach(span => span.classList.remove("highlight"));

            const current = textEl.querySelectorAll("span")[index];
            if (current) {
                current.classList.add("highlight");
                current.scrollIntoView({behavior: "smooth", block: "center"});
            }
        }

        function prepareText() {
            const textEl = document.getElementById("text");
            const rawText = textEl.textContent.trim();
            if (!rawText) return [];
            const wordList = rawText.split(/\s+/);

            // Replace text content with spans for each word
            textEl.innerHTML = wordList.map(w => `<span>${w}</span>`).join(" ");
            return wordList;
        }

        function step() {
            if (i >= words.length) {
                isPlaying = false;
                document.getElementById("playPauseBtn").textContent = "‚ñ∂";
                return;
            }

            const word = words[i];
            const base = 60000 / document.getElementById("wpm").value;
            const display = document.getElementById("display");

            display.innerHTML = render(word);
            lockPivot(); //Surja15 : "this is the key"
            highlightCurrentWord(i);
            document.getElementById("progressFill").style.width =
    (((i + 1) / words.length) * 100) + "%";

            i++;
            timer = setTimeout(() => step(), delayFor(word, base));
            if (i >= words.length) {
    document.getElementById("progressFill").style.width = "100%";
    isPlaying = false;
    document.getElementById("playPauseBtn").textContent = "‚ñ∂";
    return;
}
        }

        function start() {
            if (!words.length) {
                words = prepareText();
                i = 0;
            }
            if (!timer) step();
            isPlaying = true;
            document.getElementById("playPauseBtn").textContent = "‚è∏";
        }

        function pause() {
            clearTimeout(timer);
            timer = null;
            isPlaying = false;
            document.getElementById("playPauseBtn").textContent = "‚ñ∂";
        }

        function stop() {
            clearTimeout(timer);
            timer = null;
            i = 0;
            words = [];
            isPlaying = false;
            document.getElementById("display").innerHTML = "";
            const textEl = document.getElementById("text");
            textEl.querySelectorAll("span").forEach(span => span.classList.remove("highlight"));
            document.getElementById("playPauseBtn").textContent = "‚ñ∂";
            document.getElementById("progressFill").style.width = "0%";

        }

        function togglePlayPause() {
            if (isPlaying) {
                pause();
            } else {
                start();
            }
        }

        window.addEventListener("resize", lockPivot);
        document.getElementById("text").addEventListener("click", (e) => {
    if (e.target.tagName !== "SPAN") return;

    const spans = Array.from(document.getElementById("text").querySelectorAll("span"));
    const index = spans.indexOf(e.target);
    if (index === -1) return;

    // Stop current playback
    clearTimeout(timer);
    timer = null;

    // Seek
    i = index;

    // If already playing, continue from here
    if (isPlaying) {
        step();
    } else {
        highlightCurrentWord(i);
    }
});

    </script>
    <!-- Bottom panel -->
    <div id="bottomPanel">
        @Surja15, 2026
        
    </div>
</body>
</html>
